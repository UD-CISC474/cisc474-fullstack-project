<div class="container">
  <!-- Left Section -->
  <div class="left-section">
    <h2>Stocks</h2>

    <!-- Search Bar -->
    <div class="search-bar-container">
      <input
        type="text"
        class="search-bar"
        placeholder="Search for a ticker..."
        [(ngModel)]="searchQuery"
        (input)="filterTickers()"
        aria-label="Search for a stock ticker"
      />
    </div>

    <!-- Stock List -->
    <div class="stock-list">
      <div
        *ngFor="let ticker of paginatedTickers"
        class="stock-item"
        (click)="selectTicker(ticker)"
        tabindex="0"
        (keyup.enter)="selectTicker(ticker)"
        role="button"
      >
        <span class="stock-name">{{ ticker.T }}</span>
        <span class="stock-price">{{ ticker.c }} USD</span>
      </div>
      <div *ngIf="paginatedTickers.length === 0" class="no-results">
        No stocks found.
      </div>
    </div>

    <!-- Pagination Controls -->
    <div class="pagination-controls">
      <button
        mat-icon-button
        (click)="goToPage(currentPage - 1)"
        [disabled]="currentPage === 1"
        aria-label="Go to previous page"
      >
        <mat-icon>chevron_left</mat-icon>
      </button>
      <span aria-live="polite">Page {{ currentPage }} of {{ totalPages }}</span>
      <button
        mat-icon-button
        (click)="goToPage(currentPage + 1)"
        [disabled]="currentPage === totalPages"
        aria-label="Go to next page"
      >
        <mat-icon>chevron_right</mat-icon>
      </button>
    </div>
  </div>

  <!-- Right Section -->
  <div class="right-section">
    <div class="graph-content">
      <!-- Selected Stock Details -->
      <div class="graph-header">
        <h3>{{ selectedTicker?.T || "Select a Stock" }}</h3>
        <p>
          Current Price:
          <span> {{ selectedTicker?.c || "Loading" }} USD </span>
        </p>
        <p>
          You own:
          <span>{{ selectedTicker?.us || "0" }}</span>
          <span> shares, totaling to $</span>
          <span> {{ selectedTicker?.uv || "0" }} USD </span>
        </p>
        <ng-template #noSelection>
          <span>Loading...</span>
        </ng-template>

        <!-- Stock Purchase Section -->
        <div class="purchase-controls">
          <label for="stock-amount">Amount:</label>
          <div class="amount-buttons">
            <button
              mat-icon-button
              (click)="decreaseAmount()"
              [disabled]="amount === 1"
            >
              <mat-icon>remove</mat-icon>
            </button>
            <input
              id="stock-amount"
              type="number"
              [(ngModel)]="amount"
              min="1"
              aria-label="Enter the number of shares"
            />
            <button mat-icon-button (click)="increaseAmount()">
              <mat-icon>add</mat-icon>
            </button>
          </div>
          <div>
            <button
              (click)="buyStock(amount)"
              [disabled]="!selectedTicker || amount <= 0"
              aria-label="Buy selected stock"
            >
              Buy
            </button>
            <button
              (click)="sellStock(amount)"
              aria-label="Sell selected stock"
            >
              Sell
            </button>
          </div>
        </div>
      </div>

      <!-- Graph Placeholder -->
      <div class="graph">
        <canvas id="stockChart"></canvas>
      </div>

      <!-- Graph Period Buttons -->
      <div class="graph-buttons-container">
        <button
          *ngFor="let period of ['1D', '5D', '1M', '6M', '1Y', '2Y']"
          class="graph-button"
          (click)="loadGraphData(period)"
        >
          {{ period }}
        </button>
      </div>
    </div>
  </div>
</div>
